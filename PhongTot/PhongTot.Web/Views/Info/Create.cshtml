
@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@*<div ng-controller="infoController" >
        <div class="">
            <table border="1">
                <tr ng-repeat="items in Info">
                    <td>{{items.Name}}</td>
                    <td>{{items.Description}}</td>
                </tr>
            </table>
        </div>
    </div>*@
<div class="col-md-12 submit-room-breadcrumb">
    <div class="pt-breadcrumb">
        <ol class="breadcrumb">
            <li><a href="http://phongtot.vn">Trang chủ</a></li>
            <li class="active">Đăng tin</li>
        </ol>
    </div>
</div>
<form ng-controller="infoController" novalidate name="frmAddInfo" role="form" ng-submit="createInfo(infoAdd)">
    <div class="col-md-2 no-padding-vertical submit-room-main-content">

        <div class="submit-list-type">
            <div class="list-type-title">
                <ul>
                    <li class="li-label">Chọn Nhu Cầu</li>
                </ul>
            </div>
            <div class="checkbox checkbox-success">
                <ul>
                    <li>
                        <input type="radio" name="aaa" id="radio_needed_lease" value="Ở Trọ">
                        <label for="radio_needed_lease">Ở Trọ</label>
                    </li>
                    <li>
                        <input type="radio" name="aaa" id="radio_needed_share" value="Ở ghép">
                        <label for="radio_needed_share"> Ở ghép</label>
                    </li>
                </ul>
            </div>
        </div>
        <div id="step-2" class="submit-list-type">
            <div class="list-type-title">
                <ul><li class="li-label">Chọn loại Phòng</li></ul>
            </div>
            <div class="checkbox checkbox-success">
                <ul>
                    <li ng-repeat="items in categoryinfo">
                        <input type="radio" ng-model="infoAdd.CategoryID"   name="needed" id="{{items.ID}}" value="{{items.ID}}">
                        <label for="{{items.ID}}">{{items.Name}}</label>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div id="step-3"  class="col-md-10 no-padding-right submit-room-main-content" style="display: block;">
        <div class="list-type-title">
            <ul><li class="li-label">Bước 3 Nhập Thông Tin Chi Tiết</li></ul>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <div class="control-label">Tiêu đề</div>
                    <div>
                        <input type="text" id="title" name="Name" ng-change="GetSeoTitle()" ng-maxlength="256" required ng-model="infoAdd.Name" class="form-control" value="">
                        <span class="help-block"></span>
                        @*<span ng-show="frmAddInfo.Name.$invalid">Phải nhập Ten Tin</span>
                            <span ng-show="frmAddInfo.Name.$error.maxlength">Tên danh mục chỉ được 256 ký tự</span>*@
                    </div>
                </div>
                <div class="form-group">
                    <div class="control-label">Seo Title</div>
                    <div>
                        <input type="text" name="Alias" ng-model="infoAdd.Alias" class="form-control" value="">
                        <span class="help-block"></span>
                    </div>
                </div>
                <div class="col-md-6 no-padding-left">
                    <div class="form-group">
                        <div>
                            <div class="control-label">Giá</div>
                            <div class="input-group">
                                <input type="text" name="Price" ng-model="infoAdd.Price" class="form-control money-input" data-thousands="," data-decimal="." data-precision="0">
                                <span class="input-group-addon">đ/tháng</span>
                            </div>
                            <span class="help-block"></span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 no-padding-right">
                    <div class="form-group">
                        <div>
                            <div class="control-label">Diện tích</div>
                            <div class="input-group">
                                <input type="text" name="Acreage" ng-model="infoAdd.Acreage" class="form-control" placeholder="nhập số, viết liền">
                                <span class="input-group-addon">M<sup>2</sup></span>
                                <span class="help-block"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="control-label">Tỉnh/Thành phố</div>
                            <div>
                                <select name="province_id" ng-change="getAlDistrictByProvince(infoAdd.Provinceid)" ng-model="infoAdd.Provinceid" ng-options="option.provinceid as option.name for option in province" class="form-control address_input">
                                    <option value="">Chọn</option>
                                </select>
                                <span class="help-block"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="control-label">Quận/Huyện</div>
                            <div>
                                <select name="district_id" ng-change="getAlWardByDistrict(infoAdd.Districtid)" ng-model="infoAdd.Districtid" ng-options="option.districtid1 as option.name for option in district" class="form-control address_input">
                                    <option value="">Chọn Tỉnh/Thành trước</option>
                                </select>
                                <span class="help-block"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <dv class="clearfix"></dv>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="control-label">Xã/Phường</div>
                            <div>
                                <select id="street_id" name="ward_id" ng-model="infoAdd.Wardid" ng-options="option.wardid1 as option.name for option in ward" class="form-control address_input" size="1">
                                    <option value="">Chọn Quận/huyện trước</option>
                                </select>
                                <span class="help-block"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="control-label">Số Điện Thoại</div>
                            <div>
                                <input type="text" name="Phone" ng-model="infoAdd.Phone" class="form-control address_input" value="">
                                <span class="help-block"></span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div id="additional-row">
                <div class="col-md-12">
                    <div class="list-type-title">
                        <ul><li class="li-label">Thông tin bổ sung <span></span></li></ul>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="tang">
                                    <div class="control-label">Phòng Ngủ</div>
                                    <div>
                                        <select name="floor" ng-model="infoAdd.OtherInfo.FloorNumber" class="form-control" size="1">
                                            <option value="Chưa xác định">Chọn..</option>
                                            <option value="Tầng 1">Tầng 1</option>
                                            <option value="Tầng 2">Tầng 2</option>
                                            <option value="Tầng 3">Tầng 3</option>
                                            <option value="Tầng 4">Tầng 4</option>
                                            <option value="Tầng 5">Tầng 5</option>
                                            <option value="Tầng 6">Tầng 6</option>
                                            <option value="Tầng 7">Tầng 7</option>
                                            <option value="Tầng 8">Tầng 8</option>
                                            <option value="Tầng 9">Tầng 9</option>
                                            <option value="Tầng 10">Tầng 10</option>
                                            <option value="Chưa xác định">Chưa xác định</option>
                                        </select>
                                        <span class="help-block"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="vs">
                                    <div class="control-label">Vệ sinh</div>
                                    <div>
                                        <select name="wc" ng-model="infoAdd.OtherInfo.ToiletNumber" class="form-control" size="1">
                                            <option value="Chưa xác định">Chọn..</option>
                                            <option value="Khép kín">Khép kín</option>
                                            <option value="Chung">Chung</option>
                                            <option value="Chưa xác định">Chưa xác định</option>
                                        </select>
                                        <span class="help-block"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="tang">
                                    <div class="control-label">Chọn Phòng Ngủ</div>
                                    <div>
                                        <select name="floor" ng-model="infoAdd.OtherInfo.BedroomNumber" class="form-control" size="1">
                                            <option value="Chưa xác định">Chọn..</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                            <option value="Chưa xác định">Chưa xác định</option>
                                        </select>
                                        <span class="help-block"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <div class="vs">
                                    <div class="control-label">Hướng nhà</div>
                                    <div>
                                        <select name="direction" ng-model="infoAdd.OtherInfo.Compass" class="form-control valid">
                                            <option value="Chưa xác định">Chọn..</option>
                                            <option value="Đông">Đông</option>
                                            <option value="Đông bắc">Đông bắc</option>
                                            <option value="Đông nam">Đông nam</option>
                                            <option value="Bắc">Bắc</option>
                                            <option value="Tây">Tây</option>
                                            <option value="Tây bắc">Tây bắc</option>
                                            <option value="Tây nam">Tây nam</option>
                                            <option value="Nam">Nam</option>
                                            <option value="Chưa xác định">Chưa xác định</option>
                                        </select>
                                        <span class="help-block"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="submit-info-title">Tiện nghi sẵn có</div>
                    <div class="form-group room-option">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox"  name="convenient[]" id="dexe" value="Chỗ để xe">
                                    <label for="dexe"> Chỗ để xe </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox" name="convenient[]"  id="sanphoi" value="Sân phơi">
                                    <label for="sanphoi"> Sân phơi </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox" name="convenient[]"  id="bep" value="Thang máy">
                                    <label for="bep"> Thang máy </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox" name="convenient[]"  id="internet" value="Internet">
                                    <label for="internet"> Internet </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox" name="convenient[]"  id="dieuhoa" value="Điều hòa">
                                    <label for="dieuhoa"> Điều hòa </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox" name="convenient[]"  id="nonglanh" value="Bình nóng lạnh">
                                    <label for="nonglanh"> Bình nóng lạnh </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox" name="convenient[]" id="maygiat" value="Máy giặt">
                                    <label for="maygiat"> Máy giặt </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox" name="convenient[]"  id="tulanh" value="Truyền hình cáp">
                                    <label for="tulanh"> TH cáp </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="checkbox checkbox-success">
                                    <input type="checkbox" name="convenient[]" id="tivi" value="Tivi">
                                    <label for="tivi"> Tivi </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="clearfix" style="height: 5px;"></div>

        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="form-group">
                    <div>
                        <div class="control-label">Hình Anh</div>
                        <div class="dropzone dz-clickable" id="dropzoneForm">
                            <div class="fallback">
                                <input name="file" ng-model="infoAdd.Image" type="file" multiple />
                                <input type="submit" value="Upload" />
                            </div>
                            <div class="dz-default dz-message">
                                <span>Đăng nhiều hình thật nhanh bằng cách kéo và thả hình vào khung này hoặc nhấn nút phía trên rồi chọn nhiều hình cùng lúc</span>
                            </div>
                        </div>                        
                        <script type="text/javascript">
                            $(document).ready(function () {
                                Dropzone.autoDiscover = false;
                                //Simple Dropzonejs
                                $("#dropzoneForm").dropzone({
                                    maxFilesize: 2, // MB
                                    maxFiles: 8,
                                    acceptedFiles: "image/*",
                                    init: function () {
                                        this.on("maxfilesexceeded", function (file) {
                                            this.removeFile(file);
                                            alert("Giới hạn số lượng hình ảnh là 8!");
                                        });
                                    },
                                    url: "/Home/SaveUploadedFile",
                                    addRemoveLinks: true,
                                    success: function (file, response) {
                                        var imgName = response;
                                        file.previewElement.classList.add("dz-success");
                                        console.log("Successfully uploaded :" + imgName);
                                    },
                                    error: function (file, response) {
                                        file.previewElement.classList.add("dz-error");
                                    },
                                    removedfile: function (file) {
                                        var name = file.name;
                                        $.ajax({
                                            type: 'POST',
                                            url: '/Home/DeleteFile',
                                            data: "id=" + name,
                                            dataType: 'html',
                                            success: function () {
                                                //alert('11');
                                            }
                                        });
                                        var _ref;
                                        return (_ref = file.previewElement) != null ? _ref.parentNode.removeChild(file.previewElement) : void 0;

                                    },

                                });
                            });
                        </script>

                        <span class="help-block"></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="form-group">
                    <div>
                        <div class="control-label">Mô Tả Chi Tiết</div>
                        <div class="">
                            <textarea ui-tinymce="tinymceOptions" ng-model="infoAdd.Content"></textarea>
                        </div>
                        <span class="help-block"></span>
                    </div>
                </div>
            </div>
        </div>
        @*<div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <div style="height:300px">
                            <div id="map"></div>
                        </div>
                    </div>
                </div>
            </div>*@

        <button type="submit" ng-disabled="frmAddInfo.$invalid" class="btn btn-success pull-right">Lưu</button>



    </div>
    
</form>
@*<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAXrrJftyVPxGsVrvtCB3QzO9SQO5RvkaU&libraries=places&callback=initAutocomplete"
        async defer></script>*@
@*<script>
        function initAutocomplete() {

            var map = new google.maps.Map(document.getElementById('map'), {
                //10.826058, 106.643504
                center: { lat: 20.9873645, lng: 105.9753225 },
                zoom: 13,
                mapTypeId: 'roadmap'

            });

            //geocoder text address
            var geocoder = new google.maps.Geocoder();
            var address = document.getElementById('pac-input').value;
            if (address == "") {
                address = $("#city option:selected").text();
            }
            if (geocoder) {
                geocoder.geocode({ 'address': address }, function (results, status) {
                    if (status === 'OK') {
                        map.setCenter(results[0].geometry.location);
                        var marker = new google.maps.Marker({
                            map: map,
                            position: results[0].geometry.location
                        });
                    } else {
                        alert('Nhập vào địa chỉ liên hệ ');
                    }
                });
            }



            // Create the search box and link it to the UI element.
            var input = document.getElementById('pac-input');
            var searchBox = new google.maps.places.SearchBox(input);
            map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

            // Bias the SearchBox results towards current map's viewport.
            map.addListener('bounds_changed', function () {
                searchBox.setBounds(map.getBounds());
            });

            var markers = [];
            // Listen for the event fired when the user selects a prediction and retrieve
            // more details for that place.
            searchBox.addListener('places_changed', function () {


                var places = searchBox.getPlaces();

                if (places.length == 0) {
                    return;
                }

                // Clear out the old markers.
                markers.forEach(function (marker) {
                    marker.setMap(null);
                });
                markers = [];


                // For each place, get the icon, name and location.
                var bounds = new google.maps.LatLngBounds();
                places.forEach(function (place) {
                    if (!place.geometry) {
                        console.log("Returned place contains no geometry");
                        return;
                    }


                    // Create a marker for each place.
                    markers.push(new google.maps.Marker({
                        map: map,
                        //icon: icon,
                        title: place.name,
                        position: place.geometry.location
                    }));

                    if (place.geometry.viewport) {
                        // Only geocodes have viewport.
                        bounds.union(place.geometry.viewport);
                    } else {
                        bounds.extend(place.geometry.location);
                    }
                });
                map.fitBounds(bounds);
            });
        }

</script>*@